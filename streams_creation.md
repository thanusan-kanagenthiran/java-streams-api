# Java Streams – Creation

## 2. Stream Creation

Below are common ways to create streams, grouped by source type for easier scanning. All method names use backticks and descriptions follow a consistent sentence structure. Java 9+ methods are marked where applicable.

### From Collections

- **`collection.stream()`**: Returns a sequential `Stream` reflecting the collection’s encounter order. Ideal for most use cases where order and single-threaded processing are sufficient.

  Example:
  ```text
  List<String> list = List.of("a", "b", "c");
  list.stream().filter(s -> !s.isEmpty()).forEach(System.out::println);
  ```

- **`collection.parallelStream()`**: Returns a parallel `Stream` that splits the collection for concurrent processing using the `ForkJoinPool.commonPool()`. Use only for CPU-intensive, stateless operations on large collections. Avoid `parallelStream()` for small collections, I/O-bound operations, or when the pipeline uses shared mutable state or stateful operations that are not thread-safe.

  When not to use `parallelStream()`:
  - Small collections where parallel overhead defeats benefits.
  - Pipelines that mutate shared state without proper synchronization.
  - I/O-bound tasks (network/file) where threading may not improve throughput.
  - When strict ordering of side effects is required.

### From Arrays

- **`Arrays.stream(array)`**: Converts an array (primitive or object) into a `Stream`, maintaining the array’s order.

  Example:
  ```text
  String[] arr = {"x", "y", "z"};
  Arrays.stream(arr).map(String::toUpperCase).toArray(String[]::new);
  ```

- For primitives, use **`IntStream`**, **`LongStream`**, or **`DoubleStream`** via `Arrays.stream(intArray)` etc., which provide primitive-specialized operations and avoid boxing.

### From Maps

- **`map.keySet().stream()`**: Creates a `Stream` of the map’s keys.
- **`map.values().stream()`**: Creates a `Stream` of the map’s values.
- **`map.entrySet().stream()`**: Creates a `Stream` of `Map.Entry<K,V>` useful for transforming or filtering based on both key and value.

  Example:
  ```text
  Map<String,Integer> m = Map.of("a",1,"b",2);
  m.entrySet().stream().filter(e -> e.getValue() > 1).forEach(System.out::println);
  ```

### Explicit streams and fixed sets

- **`Stream.of(T...)`**: Creates a `Stream` from a fixed set of elements (varargs).
- **`Stream.ofNullable(T)`** (Java 9+): Returns a single-element stream if non-null, otherwise an empty stream — useful for null-safe pipelines.
- **`Stream.empty()`**: Returns a `Stream` with no elements, often used as a default or to avoid nulls.

  Example (`Stream.of` and `Stream.ofNullable`):
  ```text
  Stream.of("a","b").forEach(System.out::println);
  Stream.ofNullable(null).count(); // 0
  ```

### Infinite or generated streams

- **`Stream.generate(Supplier)`**: Produces an infinite `Stream` where each element is generated by the supplier; typically limited with `limit()` to create a finite pipeline.
- **`Stream.iterate(seed, f)`**: Produces an infinite `Stream` by repeatedly applying a function to the previous element.
- **`Stream.iterate(seed, predicate, f)`** (Java 9+): Produces a finite `Stream` that stops when the predicate returns false.

  Example (`Stream.generate`):
  ```text
  Stream.generate(Math::random).limit(3).forEach(System.out::println);
  ```

### Combining and builders

- **`Stream.concat(streamA, streamB)`**: Concatenates two streams, processing all elements of the first then the second.
- **`Stream.builder()`**: Allows step-by-step construction of a `Stream` when elements are not known up front.

  Example (`Stream.builder`):
  ```text
  Stream.Builder<String> b = Stream.builder();
  b.add("one").add("two");
  b.build().forEach(System.out::println);
  ```

---

### Summary table

| Method | Return type | Notes |
|---|---:|---:|
| `collection.stream()` | `Stream<T>` | Sequential stream, preserves encounter order. |
| `collection.parallelStream()` | `Stream<T>` | Parallel processing using common ForkJoinPool; avoid for small or stateful workloads. |
| `Arrays.stream(array)` | `Stream<T>` / `IntStream` etc. | Use primitive streams for primitives to avoid boxing. |
| `map.entrySet().stream()` | `Stream<Map.Entry<K,V>>` | Useful for key+value transformations. |
| `Stream.of(...)` | `Stream<T>` | Fixed-element stream from varargs. |
| `Stream.ofNullable(...)` (Java 9+) | `Stream<T>` | Null-safe single-element or empty stream. |
| `Stream.empty()` | `Stream<T>` | Empty stream. |
| `Stream.generate(...)` | `Stream<T>` | Infinite; use `limit()` to bound. |
| `Stream.iterate(seed,f)` | `Stream<T>` | Infinite by default. |
| `Stream.iterate(seed,predicate,f)` (Java 9+) | `Stream<T>` | Finite when predicate becomes false. |
| `Stream.concat(a,b)` | `Stream<T>` | Concatenate two streams. |
| `Stream.builder()` | `Stream<T>` | Build programmatically. |


**See Also:** Refer to `StreamCreationExample.java` for numbered code examples demonstrating many of these creation methods.
